<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Score tests in survey regression models — svyscoretest • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Score tests in survey regression models — svyscoretest"><meta property="og:description" content="Performs two versions of the efficient score test. These are the same
for a single parameter. In the working score test, different
parameters are weighted according to the inverse of the estimated population Fisher
information. In the pseudoscore test, parameters are weighted according to the
inverse of their estimated covariance matrix."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Score tests in survey regression models</h1>
    
    <div class="hidden name"><code>svyscoretest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs two versions of the efficient score test. These are the same
for a single parameter. In the <code>working</code> score test, different
parameters are weighted according to the inverse of the estimated population Fisher
information. In the <code>pseudoscore</code> test, parameters are weighted according to the
inverse of their estimated covariance matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">model</span>, drop.terms<span class="op">=</span><span class="cn">NULL</span>, add.terms<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"working"</span>,<span class="st">"pseudoscore"</span>,<span class="st">"individual"</span><span class="op">)</span>,ddf<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>lrt.approximation <span class="op">=</span> <span class="st">"satterthwaite"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyglm</span></span>
<span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">model</span>, drop.terms<span class="op">=</span><span class="cn">NULL</span>, add.terms<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"working"</span>,<span class="st">"pseudoscore"</span>,<span class="st">"individual"</span><span class="op">)</span>, ddf<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>lrt.approximation <span class="op">=</span> <span class="st">"satterthwaite"</span>,fullrank<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>A model of a class having a <code>svyscoretest</code> method (currently
    just <code>svyglm</code>)</p></dd>

  <dt>drop.terms</dt>
<dd><p>Model formula giving terms to remove from <code>model</code></p></dd>

  <dt>add.terms</dt>
<dd><p>Model formula giving terms to add to <code>model</code></p></dd>

<dt>method</dt>
<dd><p>The type of score test to use. For a single parameter they are
  equivalent. To report tests for each column separately use <code>individual</code></p></dd>

<dt>ddf</dt>
<dd><p>denominator degrees of freedom for an F or linear combination
  of F distributions. Use <code>Inf</code> to get chi-squared
  distributions. <code>NULL</code> asks for the model residual degrees of
  freedom, which is conservative.</p></dd>

  <dt>lrt.approximation</dt>
<dd><p>For the working score, the method for computing/approximating the null
distribution: see <code><a href="pchisqsum.html">pchisqsum</a></code></p></dd>

<dt>fullrank</dt>
<dd><p>If <code>FALSE</code> and <code>method="individual"</code>, keep
  even linearly dependent columns of the
  efficient score</p></dd>

  <dt>...</dt>
<dd><p>for future expansion</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>working</code> score test will be asymptotically equivalent to the
Rao-Scott likelihood ratio test computed by <code><a href="regTermTest.html">regTermTest</a></code>
and <code><a href="anova.svyglm.html">anova.svyglm</a></code>. The paper by Rao, Scott and Skinner calls this
a "naive" score test. The null distribution is a linear combination
of chi-squared (or F) variables.</p>
<p>The <code>pseudoscore</code> test will be
asymptotically equivalent to the Wald test computed by
<code><a href="regTermTest.html">regTermTest</a></code>; it has a chi-squared (or F) null
distribution.</p>
<p>If <code>ddf</code> is negative or zero, which can happen with large numbers
of predictors and small numbers of PSUs, it will be changed to 1 with a warning.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>For "pseudoscore" and "working" score methods, a named vector with the test
statistic, degrees of freedom, and p-value. For "individual" an object
of class "svystat"</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>JNK Rao, AJ Scott, and C
Rao, J., Scott, A., &amp; Skinner, C. (1998). QUASI-SCORE TESTS WITH SURVEY
DATA. Statistica Sinica, 8(4), 1059-1070.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="regTermTest.html">regTermTest</a></code>, <code><a href="anova.svyglm.html">anova.svyglm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">myco</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dmyco</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>, strata<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">Age</span>,<span class="va">leprosy</span><span class="op">)</span>,weights<span class="op">=</span><span class="op">~</span><span class="va">wt</span>,data<span class="op">=</span><span class="va">myco</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m_full</span><span class="op">&lt;-</span><span class="fu"><a href="svyglm.html">svyglm</a></span><span class="op">(</span><span class="va">leprosy</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">7.5</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Scar</span>, family<span class="op">=</span><span class="va">quasibinomial</span>, design<span class="op">=</span><span class="va">dmyco</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">m_full</span>, <span class="op">~</span><span class="va">Scar</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rao-Scott X^2           ddf             p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.076178e+01  5.020000e+02  1.108194e-03 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">m_full</span>,add.terms<span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">7.5</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="va">Scar</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rao-Scott X^2           ddf             p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6.461623e-03  5.020000e+02  9.359637e-01 </span>
<span class="r-in"><span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">m_full</span>,add.terms<span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"pseudo"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 linear dependency removed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           X2           df          ddf            p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.221403e+01 4.000000e+00 5.020000e+02 6.491734e-24 </span>
<span class="r-in"><span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">m_full</span>,add.terms<span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"individual"</span>,fullrank<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   total     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)12.5  6.2221 1.5180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)17.5  2.7633 3.0650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)22.5 -4.3934 2.3640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)27.5  2.1967 1.6124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)32.5 -3.4778 2.7989</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">svyscoretest</span><span class="op">(</span><span class="va">m_full</span>,add.terms<span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"individual"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 linear dependency removed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   total     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)12.5  6.2221 1.5180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)17.5  2.7633 3.0650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)22.5 -4.3934 2.3640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(Age)27.5  2.1967 1.6124</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

