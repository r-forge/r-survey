<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Summary statistics for sample surveys — surveysummary • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Summary statistics for sample surveys — surveysummary"><meta property="og:description" content="Compute means, variances, ratios and totals for data from complex surveys."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summary statistics for sample surveys</h1>
    
    <div class="hidden name"><code>surveysummary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute means, variances, ratios and totals for data from complex surveys.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for survey.design</span></span>
<span><span class="fu">svymean</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,deff<span class="op">=</span><span class="cn">FALSE</span>,influence<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for survey.design2</span></span>
<span><span class="fu">svymean</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,deff<span class="op">=</span><span class="cn">FALSE</span>,influence<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for twophase</span></span>
<span><span class="fu">svymean</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,deff<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for svyrep.design</span></span>
<span><span class="fu">svymean</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, rho<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>  return.replicates<span class="op">=</span><span class="cn">FALSE</span>, deff<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for survey.design</span></span>
<span><span class="fu">svyvar</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for svyrep.design</span></span>
<span><span class="fu">svyvar</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, rho<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>   return.replicates<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span>,estimate.only<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for survey.design</span></span>
<span><span class="fu">svytotal</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,deff<span class="op">=</span><span class="cn">FALSE</span>,influence<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for survey.design2</span></span>
<span><span class="fu">svytotal</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,deff<span class="op">=</span><span class="cn">FALSE</span>,influence<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for twophase</span></span>
<span><span class="fu">svytotal</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,deff<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for svyrep.design</span></span>
<span><span class="fu">svytotal</span><span class="op">(</span><span class="va">x</span>, <span class="va">design</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, rho<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>   return.replicates<span class="op">=</span><span class="cn">FALSE</span>, deff<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svystat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svrepstat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svystat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svrepstat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svystat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">object</span>,  <span class="va">parm</span>, level <span class="op">=</span> <span class="fl">0.95</span>,df <span class="op">=</span><span class="cn">Inf</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svrepstat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">object</span>,  <span class="va">parm</span>, level <span class="op">=</span> <span class="fl">0.95</span>,df <span class="op">=</span><span class="cn">Inf</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">cv</span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">deff</span><span class="op">(</span><span class="va">object</span>, quietly<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">make.formula</span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A formula, vector or matrix</p></dd>

  <dt>design</dt>
<dd><p><code>survey.design</code> or <code>svyrep.design</code> object</p></dd>

  <dt>na.rm</dt>
<dd><p>Should cases with missing values be dropped?</p></dd>

  <dt>influence</dt>
<dd><p>Should a matrix of influence functions be returned
    (primarily to support <code><a href="svyby.html">svyby</a></code>)</p></dd>

  <dt>rho</dt>
<dd><p>parameter for Fay's variance estimator in a BRR design</p></dd>

  <dt>return.replicates</dt>
<dd><p>Return the replicate means/totals?</p></dd>

  <dt>deff</dt>
<dd><p>Return the design effect (see below)</p></dd>

  <dt>object</dt>
<dd><p>The result of one of the other survey summary functions</p></dd>

  <dt>quietly</dt>
<dd><p>Don't warn when there is no design effect computed</p></dd>

  <dt>estimate.only</dt>
<dd><p>Don't compute standard errors (useful when
    <code>svyvar</code> is used to estimate the design effect)</p></dd>

  <dt>parm</dt>
<dd><p>a specification of which parameters are to be given
    confidence intervals, either a vector of numbers or a vector of
    names. If missing, all parameters are considered.</p></dd>

  <dt>level</dt>
<dd><p>the confidence level required.</p></dd>

  <dt>df</dt>
<dd><p>degrees of freedom for t-distribution in confidence
    interval, use <code>degf(design)</code> for number of PSUs minus number of
  strata</p></dd>

  <dt>...</dt>
<dd><p>additional arguments to  methods,not currently
    used</p></dd>

  <dt>names</dt>
<dd><p>vector of character strings</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    
  
<p>These functions perform weighted estimation, with each observation being
weighted by the inverse of its sampling probability.  Except for the
table functions, these also give precision estimates that incorporate
the effects of stratification and clustering.</p>
<p>Factor variables are converted to sets of indicator variables for each
category in computing means and totals. Combining this with the
<code><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></code> function, allows crosstabulations. See
<code><a href="ftable.svystat.html">ftable.svystat</a></code> for formatting the output.</p>
<p>With <code>na.rm=TRUE</code>, all cases with missing data are removed. With
<code>na.rm=FALSE</code> cases with missing data are not removed and so will
produce missing results.  When using replicate weights and
<code>na.rm=FALSE</code> it may be useful to set
<code>options(na.action="na.pass")</code>, otherwise all replicates with any
missing results will be discarded.</p>
<p>The <code>svytotal</code> and <code>svreptotal</code> functions estimate a
population total.  Use <code>predict</code> on <code><a href="svyratio.html">svyratio</a></code> and
<code><a href="svyglm.html">svyglm</a></code>, to get ratio or regression estimates of totals.</p>
<p><code>svyvar</code> estimates the population variance. The object returned
includes the full matrix of estimated population variances and
covariances, but by default only the diagonal elements are printed. To
display the whole matrix use <code>as.matrix(v)</code> or <code>print(v,
covariance=TRUE)</code>.</p>
<p>The design effect compares the variance of a mean or total to the
variance from a study of the same size using simple random sampling
without replacement. Note that the design effect will be incorrect if
the weights have been rescaled so that they are not reciprocals of
sampling probabilities.  To obtain an estimate of the design effect
comparing to simple random sampling with replacement, which does not
have this requirement, use <code>deff="replace"</code>. This with-replacement
design effect is the square of Kish's "deft".</p>
<p>The design effect for a subset of a design conditions on the size of
the subset. That is, it compares the variance of the estimate to the
variance of an estimate based on a simple random sample of the same
size as the subset, taken from the subpopulation. So, for example,
under stratified random sampling the design effect in a subset
consisting of a single stratum will be 1.0.</p>

<p>The <code>cv</code> function computes the coefficient of variation of a
statistic such as ratio, mean or total. The default method is for any
object with methods for <code><a href="SE.html">SE</a></code> and <code>coef</code>.</p>
<p><code>make.formula</code> makes a formula from a vector of names.  This is
useful because formulas as the best way to specify variables to the
survey functions.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>Objects of class <code>"svystat"</code> or <code>"svrepstat"</code>,
    which are vectors with a <code>"var"</code> attribute giving the variance
    and a <code>"statistic"</code> attribute giving the name of the
    statistic.</p>


<p>These objects have methods for <code>vcov</code>, <code>SE</code>, <code>coef</code>,</p>
<p></p>
<p><code>confint</code>, <code>svycontrast</code>.</p>
    

    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Lumley</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="svydesign.html">svydesign</a></code>, <code><a href="as.svrepdesign.html">as.svrepdesign</a></code>,
  <code><a href="svrepdesign.html">svrepdesign</a></code> for constructing design objects.</p>
<p><code><a href="svychisq.html">degf</a></code> to extract degrees of freedom from a design.</p>
<p><code><a href="svyquantile.html">svyquantile</a></code>  for quantiles</p>  
<p><code><a href="ftable.svystat.html">ftable.svystat</a></code> for more attractive tables</p>
<p><code><a href="svyciprop.html">svyciprop</a></code> for more accurate confidence intervals for
  proportions near 0 or 1.</p>
<p><code><a href="svyttest.html">svyttest</a></code> for comparing two means.</p>
<p><code><a href="svycontrast.html">svycontrast</a></code> for linear and nonlinear functions of estimates.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## one-stage cluster sample</span></span></span>
<span class="r-in"><span>  <span class="va">dclus1</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">dnum</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, data<span class="op">=</span><span class="va">apiclus1</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">dclus1</span>, deff<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mean      SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 644.169  23.542 9.3459</span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stype</span><span class="op">)</span>,<span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mean     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(stype)E 0.786885 0.0463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(stype)H 0.076503 0.0268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(stype)M 0.136612 0.0296</span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">stype</span>, <span class="va">comp.imp</span><span class="op">)</span>, <span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       mean     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> interaction(stype, comp.imp)E.No  0.174863 0.0260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> interaction(stype, comp.imp)H.No  0.038251 0.0161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> interaction(stype, comp.imp)M.No  0.060109 0.0246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> interaction(stype, comp.imp)E.Yes 0.612022 0.0417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> interaction(stype, comp.imp)H.Yes 0.038251 0.0161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> interaction(stype, comp.imp)M.Yes 0.076503 0.0217</span>
<span class="r-in"><span>  <span class="fu"><a href="svyquantile.html">svyquantile</a></span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">dclus1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.5</span>,<span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $api00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      quantile ci.2.5 ci.97.5       se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25      552    492     627 31.47166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5       652    561     714 35.66788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.75      719    696     777 18.88300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"hasci")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "newsvyquantile"</span>
<span class="r-in"><span>  <span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">dclus1</span>, deff<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          total      SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 3404940  932235 31.311</span>
<span class="r-in"><span>  <span class="fu"><a href="svyratio.html">svyratio</a></span><span class="op">(</span><span class="op">~</span><span class="va">api.stu</span>, <span class="op">~</span><span class="va">enroll</span>, <span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ratio estimator: svyratio.survey.design2(~api.stu, ~enroll, dclus1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ratios=</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api.stu 0.8497087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEs=</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api.stu 0.008386297</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">v</span><span class="op">&lt;-</span><span class="fu">svyvar</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span><span class="op">+</span><span class="va">api99</span>, <span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">v</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       variance     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00    11183 1386.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99    12735 1450.1</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">v</span>, cov<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             variance     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00:api00    11183 1386.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99:api00    11516 1412.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00:api99    11516 1412.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99:api99    12735 1450.1</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          api00    api99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 11182.82 11516.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99 11516.33 12735.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"var")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         api00   api00   api99   api99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 1922144 1920707 1920707 1851400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 1920707 1996169 1996169 2004475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99 1920707 1996169 1996169 2004475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99 1851400 2004475 2004475 2102736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"statistic")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "variance"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># replicate weights - jackknife (this is slower)</span></span></span>
<span class="r-in"><span>  <span class="va">dstrat</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,strata<span class="op">=</span><span class="op">~</span><span class="va">stype</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>,</span></span>
<span class="r-in"><span>        data<span class="op">=</span><span class="va">apistrat</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">jkstrat</span><span class="op">&lt;-</span><span class="fu"><a href="as.svrepdesign.html">as.svrepdesign</a></span><span class="op">(</span><span class="va">dstrat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">jkstrat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mean     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 662.29 9.4089</span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stype</span><span class="op">)</span>,<span class="va">jkstrat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   mean SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(stype)E 0.71376  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(stype)H 0.12189  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(stype)M 0.16435  0</span>
<span class="r-in"><span>  <span class="fu">svyvar</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span><span class="op">+</span><span class="va">api99</span>,<span class="va">jkstrat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       variance     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00    15191 1263.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99    16518 1327.1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="svyquantile.html">svyquantile</a></span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">jkstrat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.5</span>,<span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $api00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      quantile ci.2.5 ci.97.5       se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25      565    535     597 15.71945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5       668    642     694 13.18406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.75      756    726     778 13.18406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"hasci")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "newsvyquantile"</span>
<span class="r-in"><span>  <span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">jkstrat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          total     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 3687178 114642</span>
<span class="r-in"><span>  <span class="fu"><a href="svyratio.html">svyratio</a></span><span class="op">(</span><span class="op">~</span><span class="va">api.stu</span>, <span class="op">~</span><span class="va">enroll</span>, <span class="va">jkstrat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ratio estimator: svyratio.svyrep.design(~api.stu, ~enroll, jkstrat)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ratios=</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api.stu 0.8369569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEs=</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.007772509</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># coefficients of variation</span></span></span>
<span class="r-in"><span>  <span class="fu">cv</span><span class="op">(</span><span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>,<span class="va">dstrat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 0.031092</span>
<span class="r-in"><span>  <span class="fu">cv</span><span class="op">(</span><span class="fu"><a href="svyratio.html">svyratio</a></span><span class="op">(</span><span class="op">~</span><span class="va">api.stu</span>, <span class="op">~</span><span class="va">enroll</span>, <span class="va">jkstrat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api.stu 0.00928663</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># extracting information from the results</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>,<span class="va">dstrat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  enroll </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3687178 </span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span><span class="op">+</span><span class="va">api99</span>,<span class="va">jkstrat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          api00    api99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 88.52817 91.80068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api99 91.80068 99.28025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"means")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 662.2874 629.3948</span>
<span class="r-in"><span>  <span class="fu"><a href="SE.html">SE</a></span><span class="op">(</span><span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">dstrat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 18.50851</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span><span class="op">+</span><span class="va">api00</span>, <span class="va">dclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2.5 %   97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 598.0275 690.3113</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span><span class="op">+</span><span class="va">api00</span>, <span class="va">dclus1</span><span class="op">)</span>, df<span class="op">=</span><span class="fu"><a href="svychisq.html">degf</a></span><span class="op">(</span><span class="va">dclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2.5 %   97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 593.6763 694.6625</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Design effect</span></span></span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">dstrat</span>, deff<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mean       SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 662.2874   9.4089 1.2045</span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">dstrat</span>, deff<span class="op">=</span><span class="st">"replace"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mean       SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 662.2874   9.4089 1.1656</span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">jkstrat</span>, deff<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mean       SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 662.2874   9.4089 1.2045</span>
<span class="r-in"><span>  <span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">api00</span>, <span class="va">jkstrat</span>, deff<span class="op">=</span><span class="st">"replace"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mean       SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> api00 662.2874   9.4089 1.1656</span>
<span class="r-in"><span> <span class="op">(</span><span class="va">a</span><span class="op">&lt;-</span><span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">dclus1</span>, deff<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          total      SE   DEff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 3404940  932235 31.311</span>
<span class="r-in"><span>  <span class="fu">deff</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   enroll </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31.31066 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## weights that are *already* calibrated to population size</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">dclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6194</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">apipop</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6194</span>
<span class="r-in"><span><span class="va">cdclus1</span><span class="op">&lt;-</span> <span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">dnum</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, data<span class="op">=</span><span class="va">apiclus1</span>,</span></span>
<span class="r-in"><span>fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span>,calibrate.formula<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SE.html">SE</a></span><span class="op">(</span><span class="fu">svymean</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">dclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 45.19137</span>
<span class="r-in"><span><span class="co">## not equal to SE(mean)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SE.html">SE</a></span><span class="op">(</span><span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">dclus1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">apipop</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 150.5061</span>
<span class="r-in"><span><span class="co">## equal to SE(mean)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SE.html">SE</a></span><span class="op">(</span><span class="fu">svytotal</span><span class="op">(</span><span class="op">~</span><span class="va">enroll</span>, <span class="va">cdclus1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">apipop</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          enroll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> enroll 45.19137</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

