<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Loglinear models — svyloglin • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Loglinear models — svyloglin"><meta property="og:description" content="Fit and compare hierarchical loglinear models for complex survey data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Loglinear models</h1>
    
    <div class="hidden name"><code>svyloglin.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit and compare hierarchical loglinear models for complex survey data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">svyloglin</span><span class="op">(</span><span class="va">formula</span>, <span class="va">design</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyloglin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">formula</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyloglin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">object1</span>,<span class="va">...</span>,integrate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># S3 method for anova.svyloglin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>,pval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>,<span class="st">"saddlepoint"</span>,<span class="st">"lincom"</span>,<span class="st">"chisq"</span><span class="op">)</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyloglin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span>,intercept<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>Model formula</p></dd>

  <dt>design</dt>
<dd><p>survey design object</p></dd>

  <dt>object,object1</dt>
<dd><p>loglinear model from <code>svyloglin</code></p></dd>

  <dt>pval</dt>
<dd><p>p-value approximation: see Details</p></dd>

  <dt>integrate</dt>
<dd><p>Compute the exact asymptotic p-value (slow)?</p></dd>

  <dt>...</dt>
<dd><p>not used</p></dd>

  <dt>intercept</dt>
<dd><p>Report the intercept?</p></dd>

  <dt>x</dt>
<dd><p>anova object</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The loglinear model is fitted to a multiway table with probabilities
estimated by <code><a href="surveysummary.html">svymean</a></code> and with the sample size equal to the
observed sample size, treating the resulting table as if it came from iid
multinomial sampling, as described by Rao and Scott. The
variance-covariance matrix does not include the intercept term, and so
by default neither does the <code>coef</code> method.  A Newton-Raphson
algorithm is used, rather than iterative proportional fitting, so
starting values are not needed.</p>
<p>The <code>anova</code> method computes the quantities that would be the score
(Pearson) and likelihood ratio chi-squared statistics if the data were
an iid sample. It computes four p-values for each of these, based on the
exact asymptotic distribution (see <code><a href="pchisqsum.html">pchisqsum</a></code>), a
saddlepoint approximateion to this distribution, a scaled
chi-squared distribution, and a scaled F-distribution.  When testing the
two-way interaction model against the main-effects model in a two-way
table the score statistic and p-values match the Rao-Scott tests
computed by <code><a href="svychisq.html">svychisq</a></code>.</p>
<p>The <code>anova</code> method can only compare two models if they are for
exactly the same multiway table (same variables and same order). The
<code>update</code> method will help with this. It is also much faster to use
<code>update</code> than <code>svyloglin</code> for a large data set: its time
complexity depends only on the size of the model, not on the size of the
data set.</p>
<p>It is not possible to fit a model using a variable created inline, eg
<code>I(x&lt;10)</code>, since the multiway table is based on all variables used
in the formula.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>Object of class <code>"svyloglin"</code></p>


    </div>
    <div id="references">
    <h2>References</h2>
    <p>Rao, JNK, Scott, AJ (1984) "On Chi-squared Tests For Multiway Contingency Tables with Proportions Estimated From Survey Data" Annals of Statistics 12:46-60.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="svychisq.html">svychisq</a></code>, <code><a href="svyglm.html">svyglm</a></code>,<code><a href="pchisqsum.html">pchisqsum</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dclus1</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">dnum</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, data<span class="op">=</span><span class="va">apiclus1</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">a</span><span class="op">&lt;-</span><span class="fu">svyloglin</span><span class="op">(</span><span class="op">~</span><span class="va">stype</span><span class="op">+</span><span class="va">comp.imp</span>,<span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">b</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">a</span>,<span class="op">~</span><span class="va">.</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">an</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">an</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Model 1: y ~ stype + comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: y ~ stype + comp.imp + stype:comp.imp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance= 8.376767 p= 0.0676402 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Score= 9.013874 p= 0.05738682 </span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">an</span>, pval<span class="op">=</span><span class="st">"saddlepoint"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Model 1: y ~ stype + comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: y ~ stype + comp.imp + stype:comp.imp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance= 8.376767 p= 0.05376131 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Score= 9.013874 p= 0.05547346 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">## Wald test</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="regTermTest.html">regTermTest</a></span><span class="op">(</span><span class="va">b</span>, <span class="op">~</span><span class="va">stype</span><span class="op">:</span><span class="va">comp.imp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test for stype:comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in update(a, ~.^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F =  6.382223  on  2  and  13  df: p= 0.011722 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">## linear-by-linear association</span></span></span>
<span class="r-in"><span> <span class="va">d</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">a</span>,<span class="op">~</span><span class="va">.</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">stype</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">comp.imp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">an1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">an1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Model 1: y ~ stype + comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: y ~ stype + comp.imp + as.numeric(stype):as.numeric(comp.imp) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance= 6.739685 p= 0.03853491 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Score= 7.293848 p= 0.03089338 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

