<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Design-based rank tests — svyranktest • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Design-based rank tests — svyranktest"><meta property="og:description" content="Design-based versions of k-sample rank tests.  The built-in tests are
all for location hypotheses, but the user could specify others."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Design-based rank tests</h1>
    
    <div class="hidden name"><code>svyranktest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Design-based versions of k-sample rank tests.  The built-in tests are
all for location hypotheses, but the user could specify others.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">formula</span>, <span class="va">design</span>, </span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wilcoxon"</span>, <span class="st">"vanderWaerden"</span>, <span class="st">"median"</span>,<span class="st">"KruskalWallis"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>Model formula <code>y~g</code> for outcome variable <code>y</code> and group <code>g</code></p></dd>

  <dt>design</dt>
<dd><p>A survey design object</p></dd>

  <dt>test</dt>
<dd><p>Which rank test to use: Wilcoxon, van der Waerden's normal-scores
    test, Mood's test for the median, or a function <code>f(r,N)</code> where
    <code>r</code> is the rank and <code>N</code> the estimated population
    size. "KruskalWallis" is a synonym for "wilcoxon" for more than two groups.</p></dd>

  <dt>...</dt>
<dd><p>for future expansion</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>These tests are for the null hypothesis that the population or superpopulation distributions of the response variable are different between groups, targeted at population or superpopulation alternatives. 
The 'ranks' are defined as quantiles of the pooled distribution of the variable, so they do not just go from 1 to N; the null hypothesis does not depend on the weights, but the ranks do.</p>
<p>The tests reduce to the usual Normal approximations to the usual rank tests under iid sampling.  Unlike the traditional rank tests, they are not exact in small samples.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>Object of class <code>htest</code></p>



<p>Note that with more than two groups the <code>statistic</code> element of the return value holds the numerator degrees of freedom and the <code>parameter</code> element holds the test statistic.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Lumley, T., &amp; Scott, A. J. (2013). Two-sample rank tests under complex sampling. BIOMETRIKA, 100 (4), 831-842.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="svyttest.html">svyttest</a></code>, <code><a href="svylogrank.html">svylogrank</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dclus1</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">dnum</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span>, data<span class="op">=</span><span class="va">apiclus1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">comp.imp</span>, <span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based KruskalWallis test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = 2.1367, df = 13, p-value = 0.05221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in mean rank score is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference in mean rank score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.1363158 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">comp.imp</span>, <span class="va">dclus1</span>, test<span class="op">=</span><span class="st">"median"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based median test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = 1.6866, df = 13, p-value = 0.1155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in mean rank score is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference in mean rank score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.1914286 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">stype</span>, <span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based KruskalWallis test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df = 2, Chisq = 18.31, p-value = 0.003851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">stype</span>, <span class="va">dclus1</span>, test<span class="op">=</span><span class="st">"median"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based median test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df = 2, Chisq = 15.792, p-value = 0.006481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">stype</span>, <span class="va">dclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ parameter: num [1, 1] 18.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "Chisq"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ statistic: Named num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "names")= chr "df"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ddf      : num 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ p.value  : num [1, 1] 0.00385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ method   : chr "Design-based KruskalWallis test"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data.name: chr "ell ~ stype"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr "htest"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## upper quartile</span></span></span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">comp.imp</span>, <span class="va">dclus1</span>, test<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">r</span>,<span class="va">N</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">r</span><span class="op">&gt;</span><span class="fl">0.75</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based rank test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = 2.0564, df = 13, p-value = 0.0604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in mean rank score is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference in mean rank score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.1732331 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">quantiletest</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">rval</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">r</span>,<span class="va">N</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">r</span><span class="op">&gt;</span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">rval</span>,<span class="st">"name"</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">p</span>,<span class="st">"quantile"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rval</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">comp.imp</span>, <span class="va">dclus1</span>, test<span class="op">=</span><span class="fu">quantiletest</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based 0.5 quantile test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = 1.6866, df = 13, p-value = 0.1155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in mean rank score is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference in mean rank score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.1914286 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">comp.imp</span>, <span class="va">dclus1</span>, test<span class="op">=</span><span class="fu">quantiletest</span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based 0.75 quantile test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ comp.imp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = 2.0564, df = 13, p-value = 0.0604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in mean rank score is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> difference in mean rank score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     0.1732331 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## replicate weights</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rclus1</span><span class="op">&lt;-</span><span class="fu"><a href="as.svrepdesign.html">as.svrepdesign</a></span><span class="op">(</span><span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">svyranktest</span><span class="op">(</span><span class="va">ell</span><span class="op">~</span><span class="va">stype</span>, <span class="va">rclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based KruskalWallis test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ell ~ stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df = 2, Chisq = 18.31, p-value = 0.003851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

