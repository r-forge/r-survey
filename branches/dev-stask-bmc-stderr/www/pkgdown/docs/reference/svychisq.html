<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Contingency tables for survey data — svytable • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Contingency tables for survey data — svytable"><meta property="og:description" content="Contingency tables and chisquared tests of association for survey data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Contingency tables for survey data</h1>
    
    <div class="hidden name"><code>svychisq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Contingency tables and chisquared tests of association for survey data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for survey.design</span></span>
<span><span class="fu">svytable</span><span class="op">(</span><span class="va">formula</span>, <span class="va">design</span>, Ntotal <span class="op">=</span> <span class="cn">NULL</span>, round <span class="op">=</span> <span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyrep.design</span></span>
<span><span class="fu">svytable</span><span class="op">(</span><span class="va">formula</span>, <span class="va">design</span>,</span>
<span>    Ntotal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/weights.html" class="external-link">weights</a></span><span class="op">(</span><span class="va">design</span>, <span class="st">"sampling"</span><span class="op">)</span><span class="op">)</span>, round <span class="op">=</span> <span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for survey.design</span></span>
<span><span class="fu">svychisq</span><span class="op">(</span><span class="va">formula</span>, <span class="va">design</span>, </span>
<span>   statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>,  <span class="st">"Chisq"</span>,<span class="st">"Wald"</span>,<span class="st">"adjWald"</span>,<span class="st">"lincom"</span>,</span>
<span>   <span class="st">"saddlepoint"</span>,<span class="st">"wls-score"</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyrep.design</span></span>
<span><span class="fu">svychisq</span><span class="op">(</span><span class="va">formula</span>, <span class="va">design</span>, </span>
<span>   statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>,  <span class="st">"Chisq"</span>,<span class="st">"Wald"</span>,<span class="st">"adjWald"</span>,<span class="st">"lincom"</span>,</span>
<span>   <span class="st">"saddlepoint"</span>,<span class="st">"wls-score"</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svytable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, </span>
<span>   statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>,<span class="st">"Chisq"</span>,<span class="st">"Wald"</span>,<span class="st">"adjWald"</span>,<span class="st">"lincom"</span>,<span class="st">"saddlepoint"</span><span class="op">)</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">degf</span><span class="op">(</span><span class="va">design</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for survey.design2</span></span>
<span><span class="fu">degf</span><span class="op">(</span><span class="va">design</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for svyrep.design</span></span>
<span><span class="fu">degf</span><span class="op">(</span><span class="va">design</span>, tol<span class="op">=</span><span class="fl">1e-5</span>,<span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>Model formula specifying margins for the table (using <code>+</code> only)</p></dd>

  <dt>design</dt>
<dd><p>survey object</p></dd>

  <dt>statistic</dt>
<dd><p>See Details below</p></dd>

  <dt>Ntotal</dt>
<dd><p>A population total or set of population stratum totals
    to normalise to.</p></dd>

  <dt>round</dt>
<dd><p>Should the table entries be rounded to the nearest
    integer?</p></dd>

  <dt>na.rm</dt>
<dd><p>Remove missing values</p></dd>

  <dt>object</dt>
<dd><p>Output from <code>svytable</code></p></dd>

  <dt>...</dt>
<dd><p>For <code>svytable</code> these are passed to <code>xtabs</code>. Use
    <code>exclude=NULL</code>, <code>na.action=na.pass</code> to include <code>NA</code>s
    in the table</p></dd>

  <dt>tol</dt>
<dd><p>Tolerance for <code><a href="https://rdrr.io/pkg/Matrix/man/qr-methods.html" class="external-link">qr</a></code> in computing the matrix rank</p></dd>

 </dl></div>
    <div id="details">
    <h2>Details</h2>
    
 
<p>The <code>svytable</code> function computes a weighted crosstabulation. This
is especially useful for producing graphics. It is sometimes easier
to use <code><a href="surveysummary.html">svytotal</a></code> or <code><a href="surveysummary.html">svymean</a></code>, which also
produce standard errors, design effects, etc.</p>
<p>The frequencies in the table can be normalised to some convenient total
such as 100 or 1.0 by specifying the <code>Ntotal</code> argument.  If the
formula has a left-hand side the mean or sum of this variable rather
than the frequency is tabulated.</p>
<p>The <code>Ntotal</code> argument can be either a single number or a data
frame whose first column gives the (first-stage) sampling strata and
second column the population size in each stratum.  In this second case
the <code>svytable</code> command performs `post-stratification': tabulating
and scaling to the population within strata and then adding up the
strata.</p>
<p>As with other <code>xtabs</code> objects, the output of <code>svytable</code> can be
processed by <code>ftable</code> for more attractive display. The
<code>summary</code> method for <code>svytable</code> objects calls <code>svychisq</code>
for a test of independence.</p>
<p><code>svychisq</code> computes first and second-order Rao-Scott corrections to
the Pearson chisquared test, and two Wald-type tests.</p>
<p>The default (<code>statistic="F"</code>) is the Rao-Scott second-order
correction.  The p-values are computed with a Satterthwaite
approximation to the distribution and with denominator degrees of
freedom as recommended by Thomas and Rao (1990). The alternative
<code>statistic="Chisq"</code> adjusts the Pearson chisquared statistic by a
design effect estimate and then compares it to the chisquared
distribution it would have under simple random sampling.</p>
<p>The <code>statistic="Wald"</code> test is that proposed by Koch et al (1975)
and used by the SUDAAN software package. It is a Wald test based on the
differences between the observed cells counts and those expected under
independence. The adjustment given by <code>statistic="adjWald"</code> reduces
the statistic when the number of PSUs is small compared to the number of
degrees of freedom of the test. Thomas and Rao (1987) compare these
tests and find the adjustment benefical.</p>
<p><code>statistic="lincom"</code> replaces the numerator of the Rao-Scott F with
the exact asymptotic distribution, which is a linear combination of
chi-squared variables (see <code><a href="pchisqsum.html">pchisqsum</a></code>, and
<code>statistic="saddlepoint"</code> uses a saddlepoint approximation to this
distribution.  The <code>CompQuadForm</code> package is needed for
<code>statistic="lincom"</code> but not for
<code>statistic="saddlepoint"</code>. The saddlepoint approximation is
especially useful when the p-value is very small (as in large-scale
multiple testing problems).</p>
<p><code>statistic="wls-score"</code> is an experimental implementation of the
weighted least squares score test of Lipsitz et al (2015). It is not
identical to that paper, for example, I think the denominator degrees
of freedom need to be reduced by JK for a JxK table, not (J-1)(K-1). And
it's very close to the "adjWald" test.</p>
<p>For designs using replicate weights the code is essentially the same as
for designs with sampling structure, since the necessary variance
computations are done by the appropriate methods of
<code><a href="surveysummary.html">svytotal</a></code> and <code><a href="surveysummary.html">svymean</a></code>.  The exception is that
the degrees of freedom is computed as one less than the rank of the
matrix of replicate weights (by <code>degf</code>).</p>

<p>At the moment, <code>svychisq</code> works only for 2-dimensional tables.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>The table commands return an <code>xtabs</code> object, <code>svychisq</code></p>


<p>returns a <code>htest</code> object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Davies RB (1973). "Numerical inversion of a characteristic function"
Biometrika 60:415-7</p>
<p>P. Duchesne, P. Lafaye de Micheaux (2010) "Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods", Computational Statistics and Data
Analysis, Volume 54,  858-862</p>
<p>Koch, GG, Freeman, DH, Freeman, JL (1975) "Strategies in the
multivariate analysis of data from complex surveys" International
Statistical Review 43: 59-78</p>
<p>Stuart R. Lipsitz, Garrett M. Fitzmaurice, Debajyoti Sinha, Nathanael
Hevelone, Edward Giovannucci, and Jim C. Hu (2015) "Testing for
independence in JxK contingency tables with complex sample survey data"
Biometrics 71(3): 832-840</p>
<p>Rao, JNK, Scott, AJ (1984) "On Chi-squared Tests For Multiway
Contigency Tables with Proportions Estimated From Survey Data"  Annals
of Statistics 12:46-60.</p>
<p>Sribney WM (1998) "Two-way contingency tables for survey or clustered
data" Stata Technical Bulletin 45:33-49.</p>
<p>Thomas, DR, Rao, JNK (1987) "Small-sample comparison of level and power
for simple goodness-of-fit statistics under cluster sampling" JASA 82:630-636</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Rao and Scott (1984) leave open one computational issue. In
  computing `generalised design effects' for these tests, should the
  variance under simple random sampling be estimated using the observed
  proportions or the the predicted proportions under the null
  hypothesis? <code>svychisq</code> uses the observed proportions, following
  simulations by Sribney (1998), and the choices made in Stata</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="surveysummary.html">svytotal</a></code> and <code><a href="surveysummary.html">svymean</a></code> report totals
  and proportions by category for factor variables.</p>  
<p>See <code><a href="svyby.html">svyby</a></code> and <code><a href="ftable.svystat.html">ftable.svystat</a></code> to construct
  more complex tables of summary statistics.</p>
<p>See <code><a href="svyloglin.html">svyloglin</a></code> for loglinear models.</p>
<p>See <code><a href="regTermTest.html">regTermTest</a></code> for Rao-Scott tests in regression models.</p>
<p>See  <a href="https://notstatschat.rbind.io/2019/06/08/design-degrees-of-freedom-brief-note/" class="external-link">https://notstatschat.rbind.io/2019/06/08/design-degrees-of-freedom-brief-note/</a> for an explanation of the design degrees of freedom with replicate weights.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">stype</span>, data<span class="op">=</span><span class="va">apipop</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sch.wide    E    H    M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      No   472  334  266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Yes 3949  421  752</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">dclus1</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">dnum</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, data<span class="op">=</span><span class="va">apiclus1</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 - level Cluster Sampling design</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With (15) clusters.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svydesign(id = ~dnum, weights = ~pw, data = apiclus1, fpc = ~fpc)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Probabilities:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.02954 0.02954 0.02954 0.02954 0.02954 0.02954 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population size (PSUs): 757 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "cds"      "stype"    "name"     "sname"    "snum"     "dname"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "dnum"     "cname"    "cnum"     "flag"     "pcttest"  "api00"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "api99"    "target"   "growth"   "sch.wide" "comp.imp" "both"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "awards"   "meals"    "ell"      "yr.rnd"   "mobility" "acs.k3"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "acs.46"   "acs.core" "pct.resp" "not.hsg"  "hsg"      "some.col"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "col.grad" "grad.sch" "avg.ed"   "full"     "emer"     "enroll"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "api.stu"  "fpc"      "pw"      </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="op">(</span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu">svytable</span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">stype</span>, <span class="va">dclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sch.wide         E         H         M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      No   406.1640  101.5410  270.7760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Yes 4467.8035  372.3170  575.3989</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="svychisq-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/fourfoldplot.html" class="external-link">fourfoldplot</a></span><span class="op">(</span><span class="fu">svytable</span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">comp.imp</span><span class="op">+</span><span class="va">stype</span>,design<span class="op">=</span><span class="va">dclus1</span>,round<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, conf.level<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="svychisq-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">svychisq</span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">stype</span>, <span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pearson's X^2: Rao &amp; Scott adjustment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  svychisq(~sch.wide + stype, dclus1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 5.1934, ndf = 1.4946, ddf = 20.9250, p-value = 0.02175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tbl</span>, statistic<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sch.wide    E    H    M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      No   406  102  271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Yes 4468  372  575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pearson's X^2: Rao &amp; Scott adjustment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  svychisq(~sch.wide + stype, design = dclus1, statistic = "Chisq")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 11.941, df = 2, p-value = 0.005553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="fu">svychisq</span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">stype</span>, <span class="va">dclus1</span>, statistic<span class="op">=</span><span class="st">"adjWald"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based Wald test of association</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  svychisq(~sch.wide + stype, dclus1, statistic = "adjWald")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 2.2296, ndf = 2, ddf = 13, p-value = 0.1471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">rclus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="as.svrepdesign.html">as.svrepdesign</a></span><span class="op">(</span><span class="va">dclus1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">svytable</span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">stype</span>, <span class="va">rclus1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         stype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sch.wide    E    H    M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      No   406  102  271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Yes 4468  372  575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pearson's X^2: Rao &amp; Scott adjustment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  svychisq(~sch.wide + stype, design = rclus1, statistic = "F")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 4.4639, ndf = 1.4197, ddf = 19.8762, p-value = 0.03577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="fu">svychisq</span><span class="op">(</span><span class="op">~</span><span class="va">sch.wide</span><span class="op">+</span><span class="va">stype</span>, <span class="va">rclus1</span>, statistic<span class="op">=</span><span class="st">"adjWald"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Design-based Wald test of association</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  svychisq(~sch.wide + stype, rclus1, statistic = "adjWald")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F = 2.2296, ndf = 2, ddf = 13, p-value = 0.1471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

