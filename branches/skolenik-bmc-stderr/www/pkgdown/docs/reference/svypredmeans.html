<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predictive marginal means — svypredmeans • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predictive marginal means — svypredmeans"><meta property="og:description" content="Predictive marginal means for a generalised linear model, using the method of Korn and Graubard (1999) and matching the results of SUDAAN. The predictive marginal mean for one level of a factor is the probability-weighted average of the fitted values for the model on new data where all the observations are set to that level of the factor but have whatever values of adjustment variables they really have."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predictive marginal means</h1>
    
    <div class="hidden name"><code>svypredmeans.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predictive marginal means for a generalised linear model, using the method of Korn and Graubard (1999) and matching the results of SUDAAN. The predictive marginal mean for one level of a factor is the probability-weighted average of the fitted values for the model on new data where all the observations are set to that level of the factor but have whatever values of adjustment variables they really have.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">svypredmeans</span><span class="op">(</span><span class="va">adjustmodel</span>, <span class="va">groupfactor</span>, predictat<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>adjustmodel</dt>
<dd><p>A generalised linear model fit by <code><a href="svyglm.html">svyglm</a></code> with the adjustment variable but without the factor for which predictive means are wanted</p></dd>

  <dt>groupfactor</dt>
<dd><p>A one-sided formula specifying the factor for which predictive means are wanted. Can use, eg, <code>~interaction(race,sex)</code> for combining variables.
This does not have to be a factor, but it will be modelled linearly if it isn't</p></dd>

<dt>predictat</dt>
<dd><p>A vector of the values of <code>groupfactor</code> where you want predictions.  If <code>groupfactor</code> is a factor, these must be values in the data, but if it is numeric you can interpolate/extrapolate</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>svystat</code> with the predictive marginal means and their covariance matrix.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Graubard B, Korn E (1999) "Predictive Margins with Survey Data" Biometrics 55:652-659</p>
<p>Bieler, Brown, Williams, &amp; Brogan (2010) "Estimating Model-Adjusted Risks, Risk Differences, and Risk Ratios From Complex Survey Data" Am J Epi DOI: 10.1093/aje/kwp440</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>It is possible to supply an adjustment model with only an intercept, but the results are then the same as <code><a href="surveysummary.html">svymean</a></code></p>
<p>It makes no sense to have a variable in the adjustment model that is part of the grouping factor, and will give an error message or <code>NA</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="svyglm.html">svyglm</a></code></p>
<p>Worked example using National Health Interview Survey data: <a href="https://gist.github.com/tslumley/2e74cd0ac12a671d2724" class="external-link">https://gist.github.com/tslumley/2e74cd0ac12a671d2724</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nhanes_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">SDMVPSU</span>, strata<span class="op">=</span><span class="op">~</span><span class="va">SDMVSTRA</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">WTMEC2YR</span>, nest<span class="op">=</span><span class="cn">TRUE</span>,data<span class="op">=</span><span class="va">nhanes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agesexmodel</span><span class="op">&lt;-</span><span class="fu"><a href="svyglm.html">svyglm</a></span><span class="op">(</span><span class="va">HI_CHOL</span><span class="op">~</span><span class="va">agecat</span><span class="op">+</span><span class="va">RIAGENDR</span>, design<span class="op">=</span><span class="va">nhanes_design</span>,family<span class="op">=</span><span class="va">quasibinomial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## high cholesterol by race/ethnicity, adjusted for demographic differences</span></span></span>
<span class="r-in"><span><span class="va">means</span><span class="op">&lt;-</span><span class="fu">svypredmeans</span><span class="op">(</span><span class="va">agesexmodel</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">means</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mean     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.114596 0.0065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.084718 0.0106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.123081 0.0058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.108770 0.0304</span>
<span class="r-in"><span><span class="co">## relative risks compared to non-Hispanic white</span></span></span>
<span class="r-in"><span><span class="fu"><a href="svycontrast.html">svycontrast</a></span><span class="op">(</span><span class="va">means</span>,<span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">`1`</span><span class="op">/</span><span class="va">`2`</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          nlcon     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contrast 1.074 0.0722</span>
<span class="r-in"><span><span class="fu"><a href="svycontrast.html">svycontrast</a></span><span class="op">(</span><span class="va">means</span>,<span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">`3`</span><span class="op">/</span><span class="va">`2`</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            nlcon     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contrast 0.73928 0.0923</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dstrat</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,strata<span class="op">=</span><span class="op">~</span><span class="va">stype</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, data<span class="op">=</span><span class="va">apistrat</span>, fpc<span class="op">=</span><span class="op">~</span><span class="va">fpc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">demog_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="svyglm.html">svyglm</a></span><span class="op">(</span><span class="va">api00</span><span class="op">~</span><span class="va">mobility</span><span class="op">+</span><span class="va">ell</span><span class="op">+</span><span class="va">hsg</span><span class="op">+</span><span class="va">meals</span>, design<span class="op">=</span><span class="va">dstrat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">svypredmeans</span><span class="op">(</span><span class="va">demog_model</span>,<span class="op">~</span><span class="va">enroll</span>, predictat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">300</span>,<span class="fl">1000</span>,<span class="fl">3000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        mean      SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  699.19 10.3203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 300  684.29  9.5242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000 632.13  9.3377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3000 483.11 22.8229</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

