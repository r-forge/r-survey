<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Wald test for a term in a regression model — regTermTest • survey</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Wald test for a term in a regression model — regTermTest"><meta property="og:description" content="Provides Wald test and working Wald and working likelihood ratio (Rao-Scott) test of the
  hypothesis that all coefficients associated with a particular
  regression term are zero (or have some other specified
  values). Particularly useful as a substitute for anova
  when not fitting by maximum likelihood."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wald test for a term in a regression model</h1>
    
    <div class="hidden name"><code>regTermTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides Wald test and working Wald and working likelihood ratio (Rao-Scott) test of the
  hypothesis that all coefficients associated with a particular
  regression term are zero (or have some other specified
  values). Particularly useful as a substitute for <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></code>
  when not fitting by maximum likelihood.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">regTermTest</span><span class="op">(</span><span class="va">model</span>, <span class="va">test.terms</span>, null<span class="op">=</span><span class="cn">NULL</span>,df<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wald"</span>,<span class="st">"WorkingWald"</span>,<span class="st">"LRT"</span><span class="op">)</span>, lrt.approximation<span class="op">=</span><span class="st">"saddlepoint"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>A model object with <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code> and <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></code> methods</p></dd>

  <dt>test.terms</dt>
<dd><p>Character string or one-sided formula giving name of
    term or terms to test</p></dd>

  <dt>null</dt>
<dd><p>Null hypothesis values for parameters. Default is zeros</p></dd>

  <dt>df</dt>
<dd><p>Denominator degrees of freedom for an F test. If
    <code>NULL</code> these are estimated from the model. Use <code>Inf</code> for a
  chi-squared test.</p></dd>

<dt>method</dt>
<dd><p>If <code>"Wald"</code>, the Wald-type test; if <code>"LRT"</code>
  the Rao-Scott test based on the estimated log likelihood ratio; If
  <code>"WorkingWald"</code> the Wald-type test using the variance matrix
  under simple random sampling</p></dd>

<dt>lrt.approximation</dt>
<dd><p>method for approximating the distribution of
  the LRT and Working Wald statistic; see <code><a href="pchisqsum.html">pchisqsum</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>regTermTest</code> or <code>regTermTestLRT</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The Wald test uses a chisquared or F distribution.  The two
working-model tests come from the (misspecified) working model where the
observations are independent and the weights are frequency weights. For
categorical data, this is just the model fitted to the estimated
population crosstabulation. The Rao-Scott LRT statistic is the likelihood
ratio statistic in this model.  The working Wald test statistic is the Wald statistic
in this model. The working-model tests do not have a chi-squared
sampling distribution: we use a linear combination of chi-squared or F
distributions as in <code><a href="pchisqsum.html">pchisqsum</a></code>. I believe the working Wald
test is what SUDAAN refers to as a
"Satterthwaite adjusted Wald test".</p>
<p>To match other software you will typically need to use <code>lrt.approximation="satterthwaite"</code></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Rao, JNK, Scott, AJ (1984) "On Chi-squared Tests For Multiway Contingency Tables with Proportions Estimated From Survey Data" Annals of Statistics 12:46-60.</p>
<p>Lumley T, Scott A (2012) "Partial likelihood ratio tests for the Cox model under complex sampling" Statistics in Medicine 17 JUL 2012. DOI: 10.1002/sim.5492</p>
<p>Lumley T, Scott A (2014) "Tests for Regression Models Fitted to Survey Data" Australian and New Zealand Journal of Statistics 56:1-14 DOI: 10.1111/anzs.12065</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The <code>"LRT"</code> method will not work if the model had starting values supplied for the regression coefficients. Instead, fit the two models separately and use <code>anova(model1, model2, force=TRUE)</code></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></code>, <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></code>, <code><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></code>,<code><a href="pchisqsum.html">pchisqsum</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">esoph</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ncases</span>, <span class="va">ncontrols</span><span class="op">)</span> <span class="op">~</span> <span class="va">agegp</span> <span class="op">+</span> <span class="va">tobgp</span> <span class="op">*</span> </span></span>
<span class="r-in"><span>     <span class="va">alcgp</span>, data <span class="op">=</span> <span class="va">esoph</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: binomial, link: logit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: cbind(ncases, ncontrols)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Terms added sequentially (first to last)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Df Deviance Resid. Df Resid. Dev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL                           87     367.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agegp        5  121.045        82     246.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tobgp        3   36.639        79     210.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alcgp        3  127.933        76      82.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tobgp:alcgp  9    5.451        67      76.89</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model1</span>,<span class="st">"tobgp"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test for tobgp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in glm(formula = cbind(ncases, ncontrols) ~ agegp + tobgp * alcgp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = binomial(), data = esoph)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F =  6.080611  on  3  and  67  df: p= 0.0010073 </span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model1</span>,<span class="st">"tobgp:alcgp"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test for tobgp:alcgp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in glm(formula = cbind(ncases, ncontrols) ~ agegp + tobgp * alcgp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = binomial(), data = esoph)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F =  0.5880663  on  9  and  67  df: p= 0.80234 </span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model1</span>, <span class="op">~</span><span class="va">alcgp</span><span class="op">+</span><span class="va">tobgp</span><span class="op">:</span><span class="va">alcgp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test for alcgp alcgp:tobgp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in glm(formula = cbind(ncases, ncontrols) ~ agegp + tobgp * alcgp, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = binomial(), data = esoph)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F =  8.358247  on  12  and  67  df: p= 2.2352e-09 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">api</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dclus2</span><span class="op">&lt;-</span><span class="fu"><a href="svydesign.html">svydesign</a></span><span class="op">(</span>id<span class="op">=</span><span class="op">~</span><span class="va">dnum</span><span class="op">+</span><span class="va">snum</span>, weights<span class="op">=</span><span class="op">~</span><span class="va">pw</span>, data<span class="op">=</span><span class="va">apiclus2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">model2</span><span class="op">&lt;-</span><span class="fu"><a href="svyglm.html">svyglm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">sch.wide</span><span class="op">==</span><span class="st">"Yes"</span><span class="op">)</span><span class="op">~</span><span class="va">ell</span><span class="op">+</span><span class="va">meals</span><span class="op">+</span><span class="va">mobility</span>, design<span class="op">=</span><span class="va">dclus2</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasibinomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model2</span>, <span class="op">~</span><span class="va">ell</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test for ell</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in svyglm(formula = I(sch.wide == "Yes") ~ ell + meals + mobility, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     design = dclus2, family = quasibinomial())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F =  6.055448  on  1  and  36  df: p= 0.018792 </span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model2</span>, <span class="op">~</span><span class="va">ell</span>,df<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test for ell</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in svyglm(formula = I(sch.wide == "Yes") ~ ell + meals + mobility, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     design = dclus2, family = quasibinomial())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F =  6.055448  on  1  and  36  df: p= 0.018792 </span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model2</span>, <span class="op">~</span><span class="va">ell</span>, method<span class="op">=</span><span class="st">"LRT"</span>, df<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working (Rao-Scott) LRT for ell</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in svyglm(formula = I(sch.wide == "Yes") ~ ell + meals + mobility, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     design = dclus2, family = quasibinomial())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working 2logLR =  6.781297 p= 0.0096772 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df=1</span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model2</span>, <span class="op">~</span><span class="va">ell</span><span class="op">+</span><span class="va">meals</span>, method<span class="op">=</span><span class="st">"LRT"</span>, df<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working (Rao-Scott+F) LRT for ell meals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in svyglm(formula = I(sch.wide == "Yes") ~ ell + meals + mobility, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     design = dclus2, family = quasibinomial())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working 2logLR =  4.692659 p= 0.11957 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (scale factors:  1.6 0.37 );  denominator df= 36</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">regTermTest</span><span class="op">(</span><span class="va">model2</span>, <span class="op">~</span><span class="va">ell</span><span class="op">+</span><span class="va">meals</span>, method<span class="op">=</span><span class="st">"WorkingWald"</span>, df<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working (Rao-Scott+F)  for ell meals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  in svyglm(formula = I(sch.wide == "Yes") ~ ell + meals + mobility, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     design = dclus2, family = quasibinomial())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Working Wald statistic =  4.196737 p= 0.14263 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (scale factors:  1.6 0.37 );  denominator df= 36</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by “Thomas Lumley”.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

